#!/bin/bash

# print output in red
print_red() {
   printf '\e[0;31m  %s\e[0m\n' "$1"
}

# print output in blue
print_blue() {
   printf '\e[0;34m  %s\e[0m\n' "$1"
}

# result
declare -a result=()

# find *.pacsave and *.pacnew on whole system
pacPaths=$(find / -regextype posix-extended -regex '.+\.pac(new|save)' 2> /dev/null)

# see diff
for pacPath in $pacPaths; do
	# shellcheck disable=SC2001
   filePath=$(echo "$pacPath" | sed -e 's/\.pac\(new\|save\)$//')
   # workaround to msg "2 files to edit" when using vimdiff command
   vim "$pacPath" -c "vert diffsplit $filePath"

   printf 'Remove %s? (y/n) ' "$pacPath"
   read -r
   if [[ $REPLY =~ ^[yY]$ ]]; then
      sudo rm "$pacPath"
      result+=("print_red '$pacPath has been removed'")
   else
      result+=("print_blue '$pacPath is kept'")
   fi
done

# print result
if [[ "${#result[@]}" != 0 ]]; then # if not empty
   for cmd in "${result[@]}"; do
      eval "$cmd"
   done
else
   printf 'There is no *.pacnew or *.pacsave file\n'
fi
