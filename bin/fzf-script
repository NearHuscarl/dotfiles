#!/bin/bash

# wrapper alias to set up fzf
alias fzf='
   fzf \
      --multi \
      --no-mouse \
      --cycle \
      --reverse \
      --color=info:6,bg+:8,hl+:1,hl:3,pointer:6,marker:1,spinner:6 \
      --bind=alt-k:up,alt-j:down,alt-i:abort,alt-h:backward-char,alt-l:forward-char,alt-n:backward-word,alt-m:forward-word,alt-e:jump,alt-d:kill-line,alt-t:toggle'

# edit file in vim
fe() {
   file=$(rg $HOME /etc/systemd/ --files --no-ignore --hidden --follow --no-messages \
      --glob "!undo/*" \
      | fzf --preview="cat {}") && vim "$file"
}

# xdg-open file in $HOME
ff() {
   file=$(find $HOME -type f \( \
      ! -iname "*.dbx" \
      ! -iname "*.db" \
      ! -path "*vim/undo/*" \
      \) | fzf --preview="cat {}") && xdg-open "$file"
}

# fzf + cd
fd() {
  local dir
  dir=$(find ${1:-$HOME} -type d -print 2> /dev/null | fzf +m --preview="ls {}") &&
  cd "$dir"
}

# command history
fh() {
  eval $( ([ -n "$ZSH_NAME" ] && fc -l 1 || history) | fzf +s --tac | sed 's/ *[0-9]* *//')
}

# kill process
fk() {
  local pid
  pid=$(ps -ef | sed 1d | fzf -m | awk '{print $2}')

  if [ "x$pid" != "x" ]
  then
    echo $pid | xargs kill -${1:-9}
  fi
}
