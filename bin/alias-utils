#!/bin/bash

# ============================================================================
# File:        alias-utils
# Description: Function for custom alias script
# Author:      Near Huscarl <near.huscarl@gmail.com>
# Last Change: Thu Nov 16 22:21:33 +07 2017
# Licence:     BSD 3-Clause license
# Note:        N/A
# ============================================================================

function alias-tree() { # {{{
   local pwd=${1:-$(pwd)}
   find $pwd -print | sed -e "s;$pwd;\.;g;s;[^/]*\/;|__;g;s;__|; |;g"
} # }}}
function alias-pac-install() { # {{{
   sudo pacman -S "$@"
   [[ -x $HOME/bin/pacMerge ]] && pacMerge
} # }}}
function alias-nm-connect() { # {{{
	# connect to wifi, example: nmcli dev connect wlo1
	if [[ $# == 0 ]]; then
		nmcli --pretty device connect $(nmcli device status | awk '/wifi/ {print $1}')
	# connect to saved wifi
	elif [[ $# == 1 ]]; then
		nmcli --pretty connection up "$1"
	# connect to a new wifi hotspot
	elif [[ $# == 2 ]]; then
		nmcli --pretty device wifi connect "$1" password "$2"
	else
		echo 'Too many or few argument(s)'
	fi
} # }}}
function alias-pac-update() { # {{{
   sudo pacman -Syu
   [[ -x $HOME/bin/pac_merge ]] && pac_merge
} # }}}
function alias-pac-list() { # {{{
   pacman -Ql "$1" | grep "${2:-}"
} #}}}
function alias-pac-latest-e() { # {{{
   # list nth last explicitly installed packages which is not in base/base-devel group
   explicitPkgs=$(comm -23 <(pacman -Qqe | sort) <(pacman -Qqg base base-devel | sort))
	expac -HM --timefmt='%Y-%m-%d %T' '%l\t%-20n\t%m' $explicitPkgs  | sort | tail -n ${1:-20}
} # }}}
function alias-pac-dep() { # {{{
   # print package's dependencies
   if [[ $# == 0 ]]; then
      printf "Please enter a package name\n"
   else
      pacman -Si $1 | awk -F'[:<=>]' '/^Depends/ {print $2}' | xargs -n1 | sort -u
   fi
} # }}}
function alias-aur-desc() { # {{{
   pacaur -Si $@ | grep Description | sed -e "s/^Description.*://"
} # }}}
function alias-aur-size() { # {{{
   pacaur -Qi $@ | grep "Installed Size" | sed -e "s/^Installed Size.*://"
} # }}}
function alias-aur-dep() { # {{{
   if [[ $# == 0 ]]; then
      printf "Please enter a package name\n"
   else
      pacman -Qi $1 | awk -F'[:<=>]' '/^Depends/ {print $2}' | xargs -n1 | sort -u
   fi
} # }}}
function alias-gdiff() { # {{{
   vim $1 -c "Gdiff"
} # }}}
function alias-gdiff-old() { # {{{
   [[ $# == 0 ]] && git diff || git diff HEAD~$1
} # }}}
function alias-size() { # {{{
   du -h --max-depth=${1:-0}
} # }}}
function alias-pic() { # {{{
   shopt -s nullglob

   # picture extensions
   local picExt="(jpg|png)"
   local pwd=$(pwd)

   # get all *.(jpg|png) of current path
   local allPath=("$pwd"/*.@$picExt)

   # remove $(pwd) prefix, only keep file names
   allPath=("${allPath[@]#"$pwd/"}")

   for i in "${!allPath[@]}"; do
      if [[ "${allPath[$i]}" == "$1" ]]; then
         # open sxiv in 
         # (s)cale mode: (h)eight
         # hide (b)ottom info
         # search dirs (r)ecursively for images
         # open at pic (n)umber <NUM> which is the selected picture
         sxiv -s h -b -n "$((i+1))" *.@$picExt
         shopt -u nullglob
         return 0
      fi
   done
} # }}}
function alias-rgr() { # {{{
   rootDir=$(git rev-parse --show-toplevel 2> /dev/null)
   if [[ $? == 0 ]]; then
      rg "$@" $rootDir
   else
      rg "$@" $HOME
   fi
} # }}}

# vim: foldmethod=marker
